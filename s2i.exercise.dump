[student@workstation ~]$ lab openshift-s2i start

Setting up workstation for the Guided Excercise: Creating a Containerized Application with Source-to-Image

 · Installing the tree command.................................  SUCCESS
 Checking local clone of the applications repository:
 · Folder '/home/student/DO180-apps' is a git repo.............  SUCCESS
 · Git repo '/home/student/DO180-apps' has no pending changes..  SUCCESS
 Verifying the OpenShift cluster is running:
 · Log in on OpenShift.........................................  SUCCESS
 · Check the internal registry is up and running...............  SUCCESS
 · Ensuring the 'lqtpou-s2i' project does not exist............  SUCCESS
[student@workstation ~]$ pwd
/home/student
[student@workstation ~]$ ll
total 16
drwxrwxr-x. 3 student student   21 Jul 24 10:01 courses
drwxr-xr-x. 2 student student    6 Feb 14 14:24 Desktop
drwxr-xr-x. 4 student student   35 Jul 22 08:59 DO180
drwxrwxr-x. 9 student student  226 Jul 26 10:42 DO180-apps
drwxr-xr-x. 2 student student    6 Feb 14 14:24 Documents
drwxr-xr-x. 2 student student    6 Feb 14 14:24 Downloads
drwxr-xr-x. 2 student student    6 Feb 14 14:24 Music
-rw-rw-r--. 1 student student 3421 Jul 24 11:15 mysql.processed.yaml
lrwxrwxrwx. 1 student student   16 Jul 24 05:12 notes -> DO180-apps/notes
-rwxr-xr-x. 1 student student  462 Jul 26 08:31 oclogin
lrwxrwxrwx. 1 student student   26 Jul 22 09:26 ocp4.config -> /usr/local/etc/ocp4.config
-rw-rw-r--. 1 student student 6860 Jul 24 11:12 openshift.mysql-persistent.template
drwxr-xr-x. 2 student student    6 Feb 14 14:24 Pictures
drwxr-xr-x. 2 student student    6 Feb 14 14:24 Public
drwxr-xr-x. 2 student student    6 Feb 14 14:24 Templates
drwxr-xr-x. 2 student student    6 Feb 14 14:24 Videos
[student@workstation ~]$ cd DO180-apps/
[student@workstation DO180-apps]$ ll
total 40
drwxrwxr-x. 2 student student    23 Jul  4 10:22 example
-rw-rw-r--. 1 student student  4934 Jul 24 10:46 mysql.template.para
drwxrwxr-x. 2 student student    43 Jul  4 10:22 nodejs-app
drwxrwxr-x. 2 student student    40 Jul  4 10:22 nodejs-helloworld
-rw-rw-r--. 1 student student 17746 Jul 26 10:42 notes
-rw-rw-r--. 1 student student  6860 Jul 24 09:30 openshift.mysql-persistent.template
drwxrwxr-x. 2 student student    23 Jul  4 10:22 php-helloworld
-rw-rw-r--. 1 student student    54 Jul  4 10:22 README.md
drwxrwxr-x. 2 student student    23 Jul  4 10:22 temps
drwxrwxr-x. 5 student student    51 Jul  4 10:22 todoapp
[student@workstation DO180-apps]$ git br
* master
  testbranch
[student@workstation DO180-apps]$ cat .git/config 
[core]
	repositoryformatversion = 0
	filemode = true
	bare = false
	logallrefupdates = true
[remote "origin"]
	url = https://github.com/avoker/DO180-apps
	fetch = +refs/heads/*:refs/remotes/origin/*
[branch "master"]
	remote = origin
	merge = refs/heads/master
[branch "testbranch"]
	remote = origin
	merge = refs/heads/testbranch
[student@workstation DO180-apps]$ git pull
warning: Pulling without specifying how to reconcile divergent branches is
discouraged. You can squelch this message by running one of the following
commands sometime before your next pull:

  git config pull.rebase false  # merge (the default strategy)
  git config pull.rebase true   # rebase
  git config pull.ff only       # fast-forward only

You can replace "git config" with "git config --global" to set a default
preference for all repositories. You can also pass --rebase, --no-rebase,
or --ff-only on the command line to override the configured default per
invocation.

Already up to date.
[student@workstation DO180-apps]$ git co -b s2i
Switched to a new branch 's2i'
[student@workstation DO180-apps]$ git push -u origin s2i
Gtk-Message: 08:29:12.445: Failed to load module "canberra-gtk-module"
Gtk-Message: 08:29:24.537: Failed to load module "canberra-gtk-module"
remote: Support for password authentication was removed on August 13, 2021.
remote: Please see https://docs.github.com/en/get-started/getting-started-with-git/about-remote-repositories#cloning-with-https-urls for information on currently recommended modes of authentication.
fatal: Authentication failed for 'https://github.com/avoker/DO180-apps/'
[student@workstation DO180-apps]$ git push -u origin s2i
Gtk-Message: 08:31:53.255: Failed to load module "canberra-gtk-module"
Gtk-Message: 08:32:05.234: Failed to load module "canberra-gtk-module"
Total 0 (delta 0), reused 0 (delta 0), pack-reused 0
To https://github.com/avoker/DO180-apps
   f7cd896..9ea5de0  s2i -> s2i
Branch 's2i' set up to track remote branch 's2i' from 'origin'.
[student@workstation DO180-apps]$ cd php-helloworld/
[student@workstation php-helloworld]$ ll
total 4
-rw-rw-r--. 1 student student 69 Jul  4 10:22 index.php
[student@workstation php-helloworld]$ cat index.php 
<?php
print "Hello, World! php version is " . PHP_VERSION . "\n";
?>
[student@workstation php-helloworld]$ 
[student@workstation php-helloworld]$ ll ~
total 16
drwxrwxr-x. 3 student student   21 Jul 24 10:01 courses
drwxr-xr-x. 2 student student    6 Feb 14 14:24 Desktop
drwxr-xr-x. 4 student student   35 Jul 22 08:59 DO180
drwxrwxr-x. 9 student student  226 Jul 26 10:42 DO180-apps
drwxr-xr-x. 2 student student    6 Feb 14 14:24 Documents
drwxr-xr-x. 2 student student    6 Feb 14 14:24 Downloads
drwxr-xr-x. 2 student student    6 Feb 14 14:24 Music
-rw-rw-r--. 1 student student 3421 Jul 24 11:15 mysql.processed.yaml
lrwxrwxrwx. 1 student student   16 Jul 24 05:12 notes -> DO180-apps/notes
-rwxr-xr-x. 1 student student  462 Jul 26 08:31 oclogin
lrwxrwxrwx. 1 student student   26 Jul 22 09:26 ocp4.config -> /usr/local/etc/ocp4.config
-rw-rw-r--. 1 student student 6860 Jul 24 11:12 openshift.mysql-persistent.template
drwxr-xr-x. 2 student student    6 Feb 14 14:24 Pictures
drwxr-xr-x. 2 student student    6 Feb 14 14:24 Public
drwxr-xr-x. 2 student student    6 Feb 14 14:24 Templates
drwxr-xr-x. 2 student student    6 Feb 14 14:24 Videos
[student@workstation php-helloworld]$ cat ~/oclogin 
RHT_OCP4_DEV_PASSWORD=32741f016def488f82d6
RHT_OCP4_DEV_USER=lqtpou
RHT_OCP4_GITHUB_USER=avoker
RHT_OCP4_MASTER_API=https://api.ap410.prod.nextcle.com:6443
RHT_OCP4_NEXUS_SERVER=nexus-common.apps.ap410.prod.nextcle.com
RHT_OCP4_QUAY_USER=alan_lu
RHT_OCP4_WILDCARD_DOMAIN=apps.ap410.prod.nextcle.com

echo ${RHT_OCP4_DEV_USER} : ${RHT_OCP4_DEV_PASSWORD} : ${RHT_OCP4_MASTER_API}
oc login -u ${RHT_OCP4_DEV_USER} -p ${RHT_OCP4_DEV_PASSWORD} ${RHT_OCP4_MASTER_API}
[student@workstation php-helloworld]$ cat ~/ocp4.config 
RHT_OCP4_MASTER_API=https://api.ap410.prod.nextcle.com:6443
RHT_OCP4_WILDCARD_DOMAIN=apps.ap410.prod.nextcle.com
RHT_OCP4_NEXUS_SERVER=nexus-common.apps.ap410.prod.nextcle.com
RHT_OCP4_DEV_USER=lqtpou
RHT_OCP4_DEV_PASSWORD=32741f016def488f82d6
RHT_OCP4_GITHUB_USER=avoker
RHT_OCP4_QUAY_USER=alan_lu
[student@workstation php-helloworld]$ ~/oclogin 
lqtpou : 32741f016def488f82d6 : https://api.ap410.prod.nextcle.com:6443
Login successful.

You have access to the following projects and can switch between them with 'oc project <projectname>':

  * lqtpout-deploy
    lqtpout-template

Using project "lqtpout-deploy".
[student@workstation php-helloworld]$ cd ..
[student@workstation DO180-apps]$ oc new-
new-app      new-build    new-project  
[student@workstation DO180-apps]$ oc new-
new-app      new-build    new-project  
[student@workstation DO180-apps]$ oc new-
new-app      new-build    new-project  
[student@workstation DO180-apps]$ oc new-project lqtpou-s2i
Now using project "lqtpou-s2i" on server "https://api.ap410.prod.nextcle.com:6443".

You can add applications to this project with the 'new-app' command. For example, try:

    oc new-app rails-postgresql-example

to build a new example application in Ruby. Or use kubectl to deploy a simple Kubernetes application:

    kubectl create deployment hello-node --image=k8s.gcr.io/e2e-test-images/agnhost:2.33 -- /agnhost serve-hostname

[student@workstation DO180-apps]$ git br
  master
* s2i
  testbranch
[student@workstation DO180-apps]$ oc projects
You have access to the following projects and can switch between them with ' project <projectname>':

  * lqtpou-s2i
    lqtpout-deploy
    lqtpout-template

Using project "lqtpou-s2i" on server "https://api.ap410.prod.nextcle.com:6443".
[student@workstation DO180-apps]$ oc new-app php:7.3 --name=php-helloworld https://github.com/avoker/DO180-apps#s2i --context-dir php-helloworld
--> Found image fd2077a (5 months old) in image stream "openshift/php" under tag "7.3" for "php:7.3"

    Apache 2.4 with PHP 7.3 
    ----------------------- 
    PHP 7.3 available as container is a base platform for building and running various PHP 7.3 applications and frameworks. PHP is an HTML-embedded scripting language. PHP attempts to make it easy for developers to write dynamically generated web pages. PHP also offers built-in database integration for several commercial and non-commercial database management systems, so writing a database-enabled webpage with PHP is fairly simple. The most common use of PHP coding is probably as a replacement for CGI scripts.

    Tags: builder, php, php73, rh-php73

    * The source repository appears to match: php
    * A source build using source code from https://github.com/avoker/DO180-apps#s2i will be created
      * The resulting image will be pushed to image stream tag "php-helloworld:latest"
      * Use 'oc start-build' to trigger a new build

--> Creating resources ...
    imagestream.image.openshift.io "php-helloworld" created
    buildconfig.build.openshift.io "php-helloworld" created
    deployment.apps "php-helloworld" created
    service "php-helloworld" created
--> Success
    Build scheduled, use 'oc logs -f buildconfig/php-helloworld' to track its progress.
    Application is not exposed. You can expose services to the outside world by executing one or more of the commands below:
     'oc expose service/php-helloworld' 
    Run 'oc status' to view your app.
[student@workstation DO180-apps]$ oc logs -f buildconfig/php-helloworld
Cloning "https://github.com/avoker/DO180-apps" ...
	Commit:	9ea5de0b008b01d54d80e45b032ea042557ee44d (manuals)
	Author:	Student User <student@workstation.lab.example.com>
	Date:	Tue Jul 26 10:43:16 2022 -0400
time="2022-08-09T12:44:22Z" level=info msg="Not using native diff for overlay, this may cause degraded performance for building images: kernel has CONFIG_OVERLAY_FS_REDIRECT_DIR enabled"
I0809 12:44:22.518672       1 defaults.go:102] Defaulting to storage driver "overlay" with options [mountopt=metacopy=on].
Caching blobs under "/var/cache/blobs".
Trying to pull image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746...
Getting image source signatures
Copying blob sha256:df920f1b41b8f18f9459e1c35abce96ed6a077e4cc77e4583a7af599be965b1b
Copying blob sha256:cafe1f99c39ec8cd1f8e696c7031d8c5756311c1ee87f20c65a816889714841c
Copying blob sha256:a2745c55c3c1fba0208863c387ce5d947a92be3c48577e8436c85b4712546f40
Copying blob sha256:fd3cd11aea08456c116a42669bde7cf67dc6738c227f0dd9b26d4b677e2a98f1
Copying blob sha256:e0e9ac142996019bde22d55cf51053069e0135f1aae55c9e3bdc77d591c3369b
Copying config sha256:fd2077affedb833b7b7c930dc7e3b52d9bf1c2add9ce51df1292e0cf18b207b6
Writing manifest to image destination
Storing signatures
Generating dockerfile with builder image image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746
Adding transient rw bind mount for /run/secrets/rhsm
STEP 1/9: FROM image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746
STEP 2/9: LABEL "io.openshift.build.image"="image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746"       "io.openshift.build.commit.author"="Student User <student@workstation.lab.example.com>"       "io.openshift.build.commit.date"="Tue Jul 26 10:43:16 2022 -0400"       "io.openshift.build.commit.id"="9ea5de0b008b01d54d80e45b032ea042557ee44d"       "io.openshift.build.commit.ref"="s2i"       "io.openshift.build.commit.message"="manuals"       "io.openshift.build.source-location"="https://github.com/avoker/DO180-apps"       "io.openshift.build.source-context-dir"="php-helloworld"
STEP 3/9: ENV OPENSHIFT_BUILD_NAME="php-helloworld-1"     OPENSHIFT_BUILD_NAMESPACE="lqtpou-s2i"     OPENSHIFT_BUILD_SOURCE="https://github.com/avoker/DO180-apps"     OPENSHIFT_BUILD_REFERENCE="s2i"     OPENSHIFT_BUILD_COMMIT="9ea5de0b008b01d54d80e45b032ea042557ee44d"
STEP 4/9: USER root
STEP 5/9: COPY upload/src /tmp/src
STEP 6/9: RUN chown -R 1001:0 /tmp/src
STEP 7/9: USER 1001
STEP 8/9: RUN /usr/libexec/s2i/assemble
---> Installing application source...
=> sourcing 20-copy-config.sh ...
---> 12:44:41     Processing additional arbitrary httpd configuration provided by s2i ...
=> sourcing 00-documentroot.conf ...
=> sourcing 50-mpm-tuning.conf ...
=> sourcing 40-ssl-certs.sh ...
STEP 9/9: CMD /usr/libexec/s2i/run
COMMIT temp.builder.openshift.io/lqtpou-s2i/php-helloworld-1:f92c280e
time="2022-08-09T12:44:41Z" level=warning msg="Adding metacopy option, configured globally"
Getting image source signatures
Copying blob sha256:0b054459c00a34b2b17c5b3c630f25270acb778be3e5c9369185a22d3cf9b42e
Copying blob sha256:73bf0b1db372c204a79bf1beadf847b1f9873bcdf2c48e4339d8ad292fab6efb
Copying blob sha256:84b6bd9f4d0c3e2bc727c4fb62701c07b71c5a33e9803c8f5c71d36a8515ade4
Copying blob sha256:d2ddbf27faca20065be426c2a7140f04899afbd2b811c8cd1bc3fe78b82d1c10
Copying blob sha256:1df73125d4f4eadf6563bec47f190a8303a5245536abd01848fd9cba5189b60c
Copying blob sha256:74104100b74de2b00191acae41458db2212bb3e75bca5a489efc4a2c1cd7806f
Copying config sha256:983d0aa8187cda4aa0f065f89c3de8b7c1ac17fbab3dd22188434150374636e4
Writing manifest to image destination
Storing signatures
--> 983d0aa8187
Successfully tagged temp.builder.openshift.io/lqtpou-s2i/php-helloworld-1:f92c280e
983d0aa8187cda4aa0f065f89c3de8b7c1ac17fbab3dd22188434150374636e4

Pushing image image-registry.openshift-image-registry.svc:5000/lqtpou-s2i/php-helloworld:latest ...
Getting image source signatures
Copying blob sha256:74104100b74de2b00191acae41458db2212bb3e75bca5a489efc4a2c1cd7806f
Copying blob sha256:cafe1f99c39ec8cd1f8e696c7031d8c5756311c1ee87f20c65a816889714841c
Copying blob sha256:df920f1b41b8f18f9459e1c35abce96ed6a077e4cc77e4583a7af599be965b1b
Copying blob sha256:a2745c55c3c1fba0208863c387ce5d947a92be3c48577e8436c85b4712546f40
Copying blob sha256:e0e9ac142996019bde22d55cf51053069e0135f1aae55c9e3bdc77d591c3369b
Copying blob sha256:fd3cd11aea08456c116a42669bde7cf67dc6738c227f0dd9b26d4b677e2a98f1
Copying config sha256:983d0aa8187cda4aa0f065f89c3de8b7c1ac17fbab3dd22188434150374636e4
Writing manifest to image destination
Storing signatures
Successfully pushed image-registry.openshift-image-registry.svc:5000/lqtpou-s2i/php-helloworld@sha256:6df0e9ffbc990010487f63066535568045fcc899d69587366fc72c9dda12fac1
Push successful
[student@workstation DO180-apps]$ oc get pods
NAME                              READY   STATUS      RESTARTS   AGE
php-helloworld-1-build            0/1     Completed   0          2m42s
php-helloworld-59b45c5b8d-5ptgc   1/1     Running     0          2m9s
[student@workstation DO180-apps]$ oc logs --all-containers -f php-helloword-1-build |less
[student@workstation DO180-apps]$ oc logs --all-containers -f php-helloworld-1-build |less
[student@workstation DO180-apps]$ oc get pods
NAME                              READY   STATUS      RESTARTS   AGE
php-helloworld-1-build            0/1     Completed   0          5m34s
php-helloworld-59b45c5b8d-5ptgc   1/1     Running     0          5m1s
[student@workstation DO180-apps]$ oc logs --all-containers -f php-helloworld-1-build > oc.log.__all-containers_f-php-helloworld-1-build.output
[student@workstation DO180-apps]$ less oc.log.__all-containers_f-php-helloworld-1-build.output 
[student@workstation DO180-apps]$ less oc.log.__all-containers_f-php-helloworld-1-build.output 
[student@workstation DO180-apps]$ ll
total 48
drwxrwxr-x. 2 student student    23 Jul  4 10:22 example
-rw-rw-r--. 1 student student  4934 Jul 24 10:46 mysql.template.para
drwxrwxr-x. 2 student student    43 Jul  4 10:22 nodejs-app
drwxrwxr-x. 2 student student    40 Jul  4 10:22 nodejs-helloworld
-rw-rw-r--. 1 student student 17746 Jul 26 10:42 notes
-rw-rw-r--. 1 student student  5065 Aug  9 08:50 oc.log.__all-containers_f-php-helloworld-1-build.output
-rw-rw-r--. 1 student student  6860 Jul 24 09:30 openshift.mysql-persistent.template
drwxrwxr-x. 2 student student    23 Jul  4 10:22 php-helloworld
-rw-rw-r--. 1 student student    54 Jul  4 10:22 README.md
drwxrwxr-x. 2 student student    23 Jul  4 10:22 temps
drwxrwxr-x. 5 student student    51 Jul  4 10:22 todoapp
[student@workstation DO180-apps]$ less php-hellow^C
[student@workstation DO180-apps]$ oc describe deployment/php-helloworld
Name:                   php-helloworld
Namespace:              lqtpou-s2i
CreationTimestamp:      Tue, 09 Aug 2022 08:44:09 -0400
Labels:                 app=php-helloworld
                        app.kubernetes.io/component=php-helloworld
                        app.kubernetes.io/instance=php-helloworld
Annotations:            deployment.kubernetes.io/revision: 2
                        image.openshift.io/triggers:
                          [{"from":{"kind":"ImageStreamTag","name":"php-helloworld:latest"},"fieldPath":"spec.template.spec.containers[?(@.name==\"php-helloworld\")...
                        openshift.io/generated-by: OpenShiftNewApp
Selector:               deployment=php-helloworld
Replicas:               1 desired | 1 updated | 1 total | 1 available | 0 unavailable
StrategyType:           RollingUpdate
MinReadySeconds:        0
RollingUpdateStrategy:  25% max unavailable, 25% max surge
Pod Template:
  Labels:       deployment=php-helloworld
  Annotations:  openshift.io/generated-by: OpenShiftNewApp
  Containers:
   php-helloworld:
    Image:        image-registry.openshift-image-registry.svc:5000/lqtpou-s2i/php-helloworld@sha256:6df0e9ffbc990010487f63066535568045fcc899d69587366fc72c9dda12fac1
    Ports:        8080/TCP, 8443/TCP
    Host Ports:   0/TCP, 0/TCP
    Environment:  <none>
    Mounts:       <none>
  Volumes:        <none>
Conditions:
  Type           Status  Reason
  ----           ------  ------
  Available      True    MinimumReplicasAvailable
  Progressing    True    NewReplicaSetAvailable
OldReplicaSets:  <none>
NewReplicaSet:   php-helloworld-59b45c5b8d (1/1 replicas created)
Events:
  Type    Reason             Age   From                   Message
  ----    ------             ----  ----                   -------
  Normal  ScalingReplicaSet  10m   deployment-controller  Scaled up replica set php-helloworld-6cb4f5cd4d to 1
  Normal  ScalingReplicaSet  10m   deployment-controller  Scaled up replica set php-helloworld-59b45c5b8d to 1
  Normal  ScalingReplicaSet  10m   deployment-controller  Scaled down replica set php-helloworld-6cb4f5cd4d to 0
[student@workstation DO180-apps]$ oc expose service php-helloworld --name lqtpou-helloworld
route.route.openshift.io/lqtpou-helloworld exposed
[student@workstation DO180-apps]$ oc get route
NAME                HOST/PORT                                                  PATH   SERVICES         PORT       TERMINATION   WILDCARD
lqtpou-helloworld   lqtpou-helloworld-lqtpou-s2i.apps.ap410.prod.nextcle.com          php-helloworld   8080-tcp                 None
[student@workstation DO180-apps]$ oc get route -o jsonpath='{..spec.host}{"\n"}'
lqtpou-helloworld-lqtpou-s2i.apps.ap410.prod.nextcle.com
[student@workstation DO180-apps]$ curl -s lqtpou-helloworld-lqtpou-s2i.apps.ap410.prod.nextcle.com
Hello, World! php version is 7.3.29
[student@workstation DO180-apps]$ cd php-helloworld/
[student@workstation php-helloworld]$ vi index.php 
[student@workstation php-helloworld]$ git cam "."
[s2i a10363b] .
 1 file changed, 1 insertion(+)
[student@workstation php-helloworld]$ git push
Gtk-Message: 09:01:08.021: Failed to load module "canberra-gtk-module"
Gtk-Message: 09:01:14.586: Failed to load module "canberra-gtk-module"
Enumerating objects: 7, done.
Counting objects: 100% (7/7), done.
Delta compression using up to 2 threads
Compressing objects: 100% (3/3), done.
Writing objects: 100% (4/4), 399 bytes | 399.00 KiB/s, done.
Total 4 (delta 1), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas: 100% (1/1), completed with 1 local object.
To https://github.com/avoker/DO180-apps
   9ea5de0..a10363b  s2i -> s2i
[student@workstation php-helloworld]$ oc start-build php-helloworld
build.build.openshift.io/php-helloworld-2 started
[student@workstation php-helloworld]$ oc logs php-helloworld-2-build -f
time="2022-08-09T13:03:33Z" level=info msg="Not using native diff for overlay, this may cause degraded performance for building images: kernel has CONFIG_OVERLAY_FS_REDIRECT_DIR enabled"
I0809 13:03:33.900653       1 defaults.go:102] Defaulting to storage driver "overlay" with options [mountopt=metacopy=on].
Caching blobs under "/var/cache/blobs".
Trying to pull image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746...
Getting image source signatures
Copying blob sha256:fd3cd11aea08456c116a42669bde7cf67dc6738c227f0dd9b26d4b677e2a98f1
Copying blob sha256:df920f1b41b8f18f9459e1c35abce96ed6a077e4cc77e4583a7af599be965b1b
Copying blob sha256:a2745c55c3c1fba0208863c387ce5d947a92be3c48577e8436c85b4712546f40
Copying blob sha256:cafe1f99c39ec8cd1f8e696c7031d8c5756311c1ee87f20c65a816889714841c
Copying blob sha256:e0e9ac142996019bde22d55cf51053069e0135f1aae55c9e3bdc77d591c3369b
Copying config sha256:fd2077affedb833b7b7c930dc7e3b52d9bf1c2add9ce51df1292e0cf18b207b6
Writing manifest to image destination
Storing signatures
Generating dockerfile with builder image image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746
Adding transient rw bind mount for /run/secrets/rhsm
STEP 1/9: FROM image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746
STEP 2/9: LABEL "io.openshift.build.source-location"="https://github.com/avoker/DO180-apps"       "io.openshift.build.source-context-dir"="php-helloworld"       "io.openshift.build.image"="image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746"       "io.openshift.build.commit.author"="Student User <student@workstation.lab.example.com>"       "io.openshift.build.commit.date"="Tue Aug 9 09:00:51 2022 -0400"       "io.openshift.build.commit.id"="a10363b156d3eb981e7e05f8e9f11cb29ea30c3c"       "io.openshift.build.commit.ref"="s2i"       "io.openshift.build.commit.message"="."
STEP 3/9: ENV OPENSHIFT_BUILD_NAME="php-helloworld-2"     OPENSHIFT_BUILD_NAMESPACE="lqtpou-s2i"     OPENSHIFT_BUILD_SOURCE="https://github.com/avoker/DO180-apps"     OPENSHIFT_BUILD_REFERENCE="s2i"     OPENSHIFT_BUILD_COMMIT="a10363b156d3eb981e7e05f8e9f11cb29ea30c3c"
STEP 4/9: USER root
STEP 5/9: COPY upload/src /tmp/src
STEP 6/9: RUN chown -R 1001:0 /tmp/src
STEP 7/9: USER 1001
STEP 8/9: RUN /usr/libexec/s2i/assemble
---> Installing application source...
=> sourcing 20-copy-config.sh ...
---> 13:03:54     Processing additional arbitrary httpd configuration provided by s2i ...
=> sourcing 00-documentroot.conf ...
=> sourcing 50-mpm-tuning.conf ...
=> sourcing 40-ssl-certs.sh ...
STEP 9/9: CMD /usr/libexec/s2i/run
COMMIT temp.builder.openshift.io/lqtpou-s2i/php-helloworld-2:71df0d80
time="2022-08-09T13:03:54Z" level=warning msg="Adding metacopy option, configured globally"
Getting image source signatures
Copying blob sha256:0b054459c00a34b2b17c5b3c630f25270acb778be3e5c9369185a22d3cf9b42e
Copying blob sha256:73bf0b1db372c204a79bf1beadf847b1f9873bcdf2c48e4339d8ad292fab6efb
Copying blob sha256:84b6bd9f4d0c3e2bc727c4fb62701c07b71c5a33e9803c8f5c71d36a8515ade4
Copying blob sha256:d2ddbf27faca20065be426c2a7140f04899afbd2b811c8cd1bc3fe78b82d1c10
Copying blob sha256:1df73125d4f4eadf6563bec47f190a8303a5245536abd01848fd9cba5189b60c
Copying blob sha256:3a638b352dc3ce107e791c9d54309cc66dbb3bfd704ce8cd22c4ef9becf5fcfa
Copying config sha256:e953e6265ab225b1eaccbfddc582efce1bf2e4519ee7846353973f12b22f59e7
Writing manifest to image destination
Storing signatures
--> e953e6265ab
Successfully tagged temp.builder.openshift.io/lqtpou-s2i/php-helloworld-2:71df0d80
e953e6265ab225b1eaccbfddc582efce1bf2e4519ee7846353973f12b22f59e7

Pushing image image-registry.openshift-image-registry.svc:5000/lqtpou-s2i/php-helloworld:latest ...
Getting image source signatures
Copying blob sha256:fd3cd11aea08456c116a42669bde7cf67dc6738c227f0dd9b26d4b677e2a98f1
Copying blob sha256:e0e9ac142996019bde22d55cf51053069e0135f1aae55c9e3bdc77d591c3369b
Copying blob sha256:cafe1f99c39ec8cd1f8e696c7031d8c5756311c1ee87f20c65a816889714841c
Copying blob sha256:a2745c55c3c1fba0208863c387ce5d947a92be3c48577e8436c85b4712546f40
Copying blob sha256:df920f1b41b8f18f9459e1c35abce96ed6a077e4cc77e4583a7af599be965b1b
Copying blob sha256:3a638b352dc3ce107e791c9d54309cc66dbb3bfd704ce8cd22c4ef9becf5fcfa
Copying config sha256:e953e6265ab225b1eaccbfddc582efce1bf2e4519ee7846353973f12b22f59e7
Writing manifest to image destination
Storing signatures
Successfully pushed image-registry.openshift-image-registry.svc:5000/lqtpou-s2i/php-helloworld@sha256:13a0705ef77208c1b9902489c8c7ab629448e5de10e1e92db7c7c1bd065a10f8
Push successful
[student@workstation php-helloworld]$ oc get pods
NAME                             READY   STATUS      RESTARTS   AGE
php-helloworld-1-build           0/1     Completed   0          20m
php-helloworld-2-build           0/1     Completed   0          72s
php-helloworld-bbd5f577d-4p6rk   1/1     Running     0          36s
[student@workstation php-helloworld]$ curl -s lqtpou-helloworld-lqtpou-s2i.apps.ap410.prod.nextcle.com
<br />
<b>Parse error</b>:  syntax error, unexpected '\' (T_NS_SEPARATOR) in <b>/opt/app-root/src/index.php</b> on line <b>3</b><br />
[student@workstation php-helloworld]$ oc get route
NAME                HOST/PORT                                                  PATH   SERVICES         PORT       TERMINATION   WILDCARD
lqtpou-helloworld   lqtpou-helloworld-lqtpou-s2i.apps.ap410.prod.nextcle.com          php-helloworld   8080-tcp                 None
[student@workstation php-helloworld]$ oc get
You must specify the type of resource to get. Use "oc api-resources" for a complete list of supported resources.

error: Required resource not specified.
Use "oc explain <resource>" for a detailed description of that resource (e.g. oc explain pods).
See 'oc get -h' for help and examples
[student@workstation php-helloworld]$ oc get all
NAME                                 READY   STATUS      RESTARTS   AGE
pod/php-helloworld-1-build           0/1     Completed   0          22m
pod/php-helloworld-2-build           0/1     Completed   0          2m53s
pod/php-helloworld-bbd5f577d-4p6rk   1/1     Running     0          2m17s

NAME                     TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)             AGE
service/php-helloworld   ClusterIP   172.30.229.238   <none>        8080/TCP,8443/TCP   22m

NAME                             READY   UP-TO-DATE   AVAILABLE   AGE
deployment.apps/php-helloworld   1/1     1            1           22m

NAME                                        DESIRED   CURRENT   READY   AGE
replicaset.apps/php-helloworld-59b45c5b8d   0         0         0       21m
replicaset.apps/php-helloworld-6cb4f5cd4d   0         0         0       22m
replicaset.apps/php-helloworld-bbd5f577d    1         1         1       2m17s

NAME                                            TYPE     FROM      LATEST
buildconfig.build.openshift.io/php-helloworld   Source   Git@s2i   2

NAME                                        TYPE     FROM          STATUS     STARTED          DURATION
build.build.openshift.io/php-helloworld-1   Source   Git@9ea5de0   Complete   22 minutes ago   34s
build.build.openshift.io/php-helloworld-2   Source   Git@a10363b   Complete   2 minutes ago    37s

NAME                                            IMAGE REPOSITORY                                                                               TAGS     UPDATED
imagestream.image.openshift.io/php-helloworld   default-route-openshift-image-registry.apps.ap410.prod.nextcle.com/lqtpou-s2i/php-helloworld   latest   2 minutes ago

NAME                                         HOST/PORT                                                  PATH   SERVICES         PORT       TERMINATION   WILDCARD
route.route.openshift.io/lqtpou-helloworld   lqtpou-helloworld-lqtpou-s2i.apps.ap410.prod.nextcle.com          php-helloworld   8080-tcp                 None
[student@workstation php-helloworld]$ curl -s lqtpou-helloworld-lqtpou-s2i.apps.ap410.prod.nextcle.com
<br />
<b>Parse error</b>:  syntax error, unexpected '\' (T_NS_SEPARATOR) in <b>/opt/app-root/src/index.php</b> on line <b>3</b><br />
[student@workstation php-helloworld]$ ll
total 4
-rw-rw-r--. 1 student student 102 Aug  9 09:00 index.php
[student@workstation php-helloworld]$ cat index.php 
<?php
print "Hello, World! php version is " . PHP_VERSION . "\n";
print "A change is comming!"\n";
?>
[student@workstation php-helloworld]$ vi index.php 
[student@workstation php-helloworld]$ git cam "fix"
[s2i 8406d7a] fix
 1 file changed, 1 insertion(+), 1 deletion(-)
[student@workstation php-helloworld]$ git push
Enumerating objects: 7, done.
Counting objects: 100% (7/7), done.
Delta compression using up to 2 threads
Compressing objects: 100% (3/3), done.
Writing objects: 100% (4/4), 344 bytes | 344.00 KiB/s, done.
Total 4 (delta 2), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas: 100% (2/2), completed with 2 local objects.
To https://github.com/avoker/DO180-apps
   a10363b..8406d7a  s2i -> s2i
[student@workstation php-helloworld]$ oc start-build
error: Must pass a name of a build config or specify build name with '--from-build' flag.
Use "oc get buildconfig" to list all available build configs.
See 'oc start-build -h' for help and examples
[student@workstation php-helloworld]$ oc get bc
NAME             TYPE     FROM      LATEST
php-helloworld   Source   Git@s2i   2
[student@workstation php-helloworld]$ oc start-build php-helloworld
build.build.openshift.io/php-helloworld-3 started
[student@workstation php-helloworld]$ oc logs build.build.openshift.io/php-helloworld-3 -f
Cloning "https://github.com/avoker/DO180-apps" ...
	Commit:	8406d7aa3d53d74d7c3b5af5d3678755540ea591 (fix)
	Author:	Student User <student@workstation.lab.example.com>
	Date:	Tue Aug 9 09:08:37 2022 -0400
time="2022-08-09T13:09:41Z" level=info msg="Not using native diff for overlay, this may cause degraded performance for building images: kernel has CONFIG_OVERLAY_FS_REDIRECT_DIR enabled"
I0809 13:09:41.329603       1 defaults.go:102] Defaulting to storage driver "overlay" with options [mountopt=metacopy=on].
Caching blobs under "/var/cache/blobs".
Trying to pull image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746...
Getting image source signatures
Copying blob sha256:e0e9ac142996019bde22d55cf51053069e0135f1aae55c9e3bdc77d591c3369b
Copying blob sha256:cafe1f99c39ec8cd1f8e696c7031d8c5756311c1ee87f20c65a816889714841c
Copying blob sha256:fd3cd11aea08456c116a42669bde7cf67dc6738c227f0dd9b26d4b677e2a98f1
Copying blob sha256:a2745c55c3c1fba0208863c387ce5d947a92be3c48577e8436c85b4712546f40
Copying blob sha256:df920f1b41b8f18f9459e1c35abce96ed6a077e4cc77e4583a7af599be965b1b
Copying config sha256:fd2077affedb833b7b7c930dc7e3b52d9bf1c2add9ce51df1292e0cf18b207b6
Writing manifest to image destination
Storing signatures
Generating dockerfile with builder image image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746
Adding transient rw bind mount for /run/secrets/rhsm
STEP 1/9: FROM image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746
STEP 2/9: LABEL "io.openshift.build.image"="image-registry.openshift-image-registry.svc:5000/openshift/php@sha256:c649c4d2735cb8e03463b456aee1fa0610d5e80dc00c5efcdab08db83ff6d746"       "io.openshift.build.commit.author"="Student User <student@workstation.lab.example.com>"       "io.openshift.build.commit.date"="Tue Aug 9 09:08:37 2022 -0400"       "io.openshift.build.commit.id"="8406d7aa3d53d74d7c3b5af5d3678755540ea591"       "io.openshift.build.commit.ref"="s2i"       "io.openshift.build.commit.message"="fix"       "io.openshift.build.source-location"="https://github.com/avoker/DO180-apps"       "io.openshift.build.source-context-dir"="php-helloworld"
STEP 3/9: ENV OPENSHIFT_BUILD_NAME="php-helloworld-3"     OPENSHIFT_BUILD_NAMESPACE="lqtpou-s2i"     OPENSHIFT_BUILD_SOURCE="https://github.com/avoker/DO180-apps"     OPENSHIFT_BUILD_REFERENCE="s2i"     OPENSHIFT_BUILD_COMMIT="8406d7aa3d53d74d7c3b5af5d3678755540ea591"
STEP 4/9: USER root
STEP 5/9: COPY upload/src /tmp/src
STEP 6/9: RUN chown -R 1001:0 /tmp/src
STEP 7/9: USER 1001
STEP 8/9: RUN /usr/libexec/s2i/assemble
---> Installing application source...
=> sourcing 20-copy-config.sh ...
---> 13:10:00     Processing additional arbitrary httpd configuration provided by s2i ...
=> sourcing 00-documentroot.conf ...
=> sourcing 50-mpm-tuning.conf ...
=> sourcing 40-ssl-certs.sh ...
STEP 9/9: CMD /usr/libexec/s2i/run
COMMIT temp.builder.openshift.io/lqtpou-s2i/php-helloworld-3:ccf02aef
time="2022-08-09T13:10:00Z" level=warning msg="Adding metacopy option, configured globally"
Getting image source signatures
Copying blob sha256:0b054459c00a34b2b17c5b3c630f25270acb778be3e5c9369185a22d3cf9b42e
Copying blob sha256:73bf0b1db372c204a79bf1beadf847b1f9873bcdf2c48e4339d8ad292fab6efb
Copying blob sha256:84b6bd9f4d0c3e2bc727c4fb62701c07b71c5a33e9803c8f5c71d36a8515ade4
Copying blob sha256:d2ddbf27faca20065be426c2a7140f04899afbd2b811c8cd1bc3fe78b82d1c10
Copying blob sha256:1df73125d4f4eadf6563bec47f190a8303a5245536abd01848fd9cba5189b60c
Copying blob sha256:fd0bea2f6202f8cb8812188da83594f2307d9296860dfd7ab87c5fb40f7ff522
Copying config sha256:1e748bbe510639de71156eee76c57ed5c997091c2997cbb8968717aeb18e9f87
Writing manifest to image destination
Storing signatures
--> 1e748bbe510
Successfully tagged temp.builder.openshift.io/lqtpou-s2i/php-helloworld-3:ccf02aef
1e748bbe510639de71156eee76c57ed5c997091c2997cbb8968717aeb18e9f87

Pushing image image-registry.openshift-image-registry.svc:5000/lqtpou-s2i/php-helloworld:latest ...
Getting image source signatures
Copying blob sha256:cafe1f99c39ec8cd1f8e696c7031d8c5756311c1ee87f20c65a816889714841c
Copying blob sha256:e0e9ac142996019bde22d55cf51053069e0135f1aae55c9e3bdc77d591c3369b
Copying blob sha256:a2745c55c3c1fba0208863c387ce5d947a92be3c48577e8436c85b4712546f40
Copying blob sha256:df920f1b41b8f18f9459e1c35abce96ed6a077e4cc77e4583a7af599be965b1b
Copying blob sha256:fd3cd11aea08456c116a42669bde7cf67dc6738c227f0dd9b26d4b677e2a98f1
Copying blob sha256:fd0bea2f6202f8cb8812188da83594f2307d9296860dfd7ab87c5fb40f7ff522
Copying config sha256:1e748bbe510639de71156eee76c57ed5c997091c2997cbb8968717aeb18e9f87
Writing manifest to image destination
Storing signatures
Successfully pushed image-registry.openshift-image-registry.svc:5000/lqtpou-s2i/php-helloworld@sha256:213c6a41d2e0a7d7a9e767b2b3908717c94ed9ccaaf7b59f324e7c86fef9137b
Push successful
[student@workstation php-helloworld]$ oc get pods
NAME                              READY   STATUS      RESTARTS   AGE
php-helloworld-1-build            0/1     Completed   0          26m
php-helloworld-2-build            0/1     Completed   0          7m37s
php-helloworld-3-build            0/1     Completed   0          89s
php-helloworld-7d5df9b579-kl9tt   1/1     Running     0          56s
[student@workstation php-helloworld]$ curl -s lqtpou-helloworld-lqtpou-s2i.apps.ap410.prod.nextcle.com
Hello, World! php version is 7.3.29
A change is comming!

